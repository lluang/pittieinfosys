---
output: pdf_document
---
Lab 5: Simple Graphs with ggplot2
==========================
author: IE 0015 Information Systems
date: Week of February 4, 2016 

```{r loadlibraries}
library(ggplot2)
```

```{r, echo = FALSE}
FemPreg <- read.csv("../data/2006_2010_FemPreg.csv",
                     header=TRUE,sep=",")
```

1.  [4 pts] Read the National Survey of Family Growth Female Pregnancy dataset into R (either from CSV or SQLite). Identify the variables that corresponds to the duration of a completed pregnancy in weeks (duration of pregnancy) and the outcome (Pregnancy outcome). Plot three histograms: 

(1)  All live births, 
(2) current pregnancy (pregnancy ongoing at the time of survey), and 
(3) miscarriages. 

Include axis labels and titles (e.g. , `xlab="Pregnancy length", ylab="Number of live births", main="Pregnancy lengths of live births"`).  Give an interpretation of the third histogram (miscarriage). Note that the code book that corresponds to the data we are using (2006-2010) can be found at  http://www.cdc.gov/nchs/nsfg/nsfg_2006_2010_puf.htm Use the NSFG_2006-10_FemPreg_Codebook.

**ANSWER**

```{r, echo = TRUE}
qplot(PRGLNGTH, data = FemPreg[FemPreg$OUTCOME==1,], geom = "histogram", xlab="Pregnancy length", ylab="Number of live births", main="Pregnancy lengths of live births")
qplot(PRGLNGTH, data = FemPreg[FemPreg$OUTCOME==6,], geom = "histogram", xlab="Pregnancy length", ylab="Number of live births", main="Pregnancy lengths of current pregnancies")
qplot(PRGLNGTH, data = FemPreg[(FemPreg$OUTCOME==4),], geom = "histogram", xlab="Pregnancy length", ylab="Number of live births", main="Pregnancy lengths of miscarriages")
```


Based on the miscarriage histogram, miscarriages tend to occur in the first 20 weeks of the pregnancy.  Don't worry if they say anything in addition to this, but they should at least get this far.

Note
1. Always attach your R code, or TA will not be able to give you any points if there is difference between your graph and the preferred answer. 
2. "==" is used for comparisons while "=" indicates an assignment. 
3. Field "OUTCOME"(P55 in codebook) most accurately fit the requirement 
  - PREGEND1 (Applicable if pregnancy is a completed pregnancy) is not a full reord. In its note it says use record OUTCOME 
  - GESTASUN_W (Applicable if pregnancy is a completed pregnancy (prgoutcome = 1 or 2)) is not a full record either.
  - HOWPREG_N (Applicable if pregnancy is a current pregnancy (prgoutcome = 3)) is also a partial record. It need to be used with HOWPREG_P (Unit) to become a full reply.
  
In all the three fields above, "99"s mean "don't know". If you use those fields (or fields that have similar coding), you need to ensure they are removed from the analysis. See the use of the BIRTHWGHT_LB1 in the answer to the second question for an example.

Acceptable answer

4. Sorting function "FemPreg[FemPreg$OUTCOME==1,]" means "in the data frame FemPreg, select all the rows that OUTCOME==1, and select all the columns"

```
qplot(GESTASUN_W, data = FemPreg[FemPreg$OUTCOME==1,], geom = "histogram", xlab="Pregnancy length", ylab="Number of live births", main="Pregnancy lengths of live births")
```



2. [6] Plot the relationship between birth weight and birth order.
  a.  What are the variables that represent the birth weight in pounds (1st child of pregnancy) and the birth order?

Ignoring responses where the birth weight was not given (hint: how can you tell) make the following plots. Include axis labels and titles. (e.g. `, xlab="Pregnancy order", ylab = "Birthweight (lbs)", main = "Birthweight by pregnancy order"`)

  b.  Plot a boxplot of birth weight by pregnancy order (note: convert pregnancy order to a factor using `as.factor()`).
  c.  Plot a jitter plot of birthweight by birth order.
  d.  The jitter plot is hard to read. Set the alpha = 1/5 and plot again.
  e.  Why are there so many missing values reported when making these plots? (or what did you do to prevent missing values in this plot)
 
**ANSWER**

BIRTHWGHT_LB1 is the birth weight (of a first child born in the case of twins/triplets).
pregordr indicates birth order

```{r, echo = FALSE}
qplot(as.factor(pregordr), BIRTHWGT_LB1, data = FemPreg[FemPreg$BIRTHWGT_LB1<99,], geom = "boxplot", xlab="Pregnancy order", ylab = "Birthweight (lbs)", main = "Birthweight by pregnancy order") 
qplot(as.integer(pregordr), as.integer(BIRTHWGT_LB1), data = FemPreg[FemPreg$BIRTHWGT_LB1<99,], geom = "jitter", xlab="Pregnancy order", ylab = "Birthweight (lbs)", main = "Birthweight by pregnancy order") 
qplot(as.integer(pregordr), as.integer(BIRTHWGT_LB1), data = FemPreg[FemPreg$BIRTHWGT_LB1<99,], geom = "jitter", alpha = I(1/5), xlab="Pregnancy order", ylab = "Birthweight (lbs)", main = "Birthweight by pregnancy order")
```

There are a large number of missing values in birthweight because of pregnancies that do not result in live births.

NOTE:
1. As a similar problem in Q1, there is several answers not perfectly meet the requirement for the question. Read the full description of the fields before you use them.
BIRTHORD only applicable for all live birth while pregordr applicable for all.
2. Whenever you are not 100% sure about the usage of a function, use command like "?qplot" or "?as.factor" to get a help page.(add a ? before the command you want to use) It will help you a lot when you have questions about the order or format of function parameters.
3. Use R script to record your lines rather than write them directly on Console. You might need it next time.  If you were using the console to figure out the code, in R Studio your code is available in the History tab (upper right box)